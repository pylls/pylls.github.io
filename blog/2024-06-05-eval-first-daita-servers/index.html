<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Evaluating using the first eight DAITA servers</title>
    <meta name="description" content="A short whoami of Tobias Pulls">
    <meta name="author" content='Tobias Pulls'>

    <link rel="stylesheet" href="/font.css">
    <link rel="stylesheet" href="/bootstrap.min.css">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://pulls.name/favicon.ico">
    

    
        
  


    
</head>

    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0">
        <a class="navbar-brand mx-0 mr-sm-auto" href="https://pulls.name/">
          
          Tobias Pulls
        </a>
        <div class="navbar-nav flex-row flex-wrap justify-content-center">
            
                
                
                    <a class="nav-item nav-link" href="/resume.pdf">
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-earmark-person-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M2 2a2 2 0 0 1 2-2h5.293A1 1 0 0 1 10 .293L13.707 4a1 1 0 0 1 .293.707V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2zm7.5 1.5v-2l3 3h-2a1 1 0 0 1-1-1zM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm2 5.755S12 12 8 12s-5 1.755-5 1.755V14a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-.245z"/></svg> Resume
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="https://github.com/pylls/">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16"> <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/> </svg> Github
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="https://infosec.exchange/@pulls">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mastodon" viewBox="0 0 16 16"><path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a4 4 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522q0-1.288.66-2.046c.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764q.662.757.661 2.046z"/></svg>   
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="https://bsky.app/profile/pulls.name">
                        <svg role="img" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"height="16" width="16"><path d="M8 7.2c-0.7246666666666666 -1.409333333333333 -2.6973333333333334 -4.035333333333333 -4.532 -5.33C1.7106666666666666 0.6293333333333333 1.0406666666666666 0.844 0.6013333333333333 1.0433333333333332 0.09266666666666667 1.2719999999999998 0 2.0533333333333332 0 2.5119999999999996c0 0.45999999999999996 0.252 3.7666666666666666 0.416 4.319333333333333 0.5433333333333332 1.824 2.4753333333333334 2.44 4.255333333333333 2.2426666666666666 0.09066666666666667 -0.013333333333333332 0.18333333333333335 -0.026 0.2766666666666666 -0.03733333333333333 -0.092 0.014666666666666665 -0.184 0.026666666666666665 -0.2766666666666666 0.03733333333333333 -2.6079999999999997 0.3866666666666666 -4.924666666666666 1.3366666666666664 -1.8866666666666667 4.718666666666667 3.3419999999999996 3.46 4.58 -0.742 5.215333333333334 -2.872 0.6353333333333333 2.13 1.3666666666666665 6.180666666666667 5.155333333333333 2.872 2.844666666666667 -2.872 0.7813333333333332 -4.332 -1.8266666666666667 -4.718666666666667a5.827333333333333 5.827333333333333 0 0 1 -0.2766666666666666 -0.03733333333333333c0.09333333333333334 0.011333333333333334 0.186 0.023999999999999997 0.2766666666666666 0.03733333333333333 1.7799999999999998 0.19799999999999998 3.7119999999999997 -0.41866666666666663 4.255333333333333 -2.2426666666666666 0.16399999999999998 -0.5519999999999999 0.416 -3.86 0.416 -4.318666666666666 0 -0.45999999999999996 -0.09266666666666667 -1.2406666666666666 -0.6013333333333333 -1.4706666666666666 -0.43933333333333335 -0.19866666666666666 -1.1093333333333333 -0.41333333333333333 -2.8666666666666663 0.8266666666666667C10.697333333333333 3.1653333333333333 8.724666666666666 5.791333333333332 8 7.2Z" fill="currentColor" stroke-width="0.6667"></path></svg>  
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="https://X.com/tpulls">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter-x" viewBox="0 0 16 16"><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/></svg> 
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/blog">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-text-fill" viewBox="0 0 16 16">  <path d="M9.293 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.707A1 1 0 0 0 13.707 4L10 .293A1 1 0 0 0 9.293 0M9.5 3.5v-2l3 3h-2a1 1 0 0 1-1-1M4.5 9a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zM4 10.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5m.5 2.5a.5.5 0 0 1 0-1h4a.5.5 0 0 1 0 1z"/></svg> Blog
                    </a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<div class="container">
    <h1 id="evaluating-using-the-first-eight-daita-servers">Evaluating using the first eight DAITA servers</h1>
<p>About a month ago Mullvad released <a href="https://mullvad.net/en/blog/introducing-defense-against-ai-guided-traffic-analysis-daita">Defense against AI-guided Traffic Analysis
(DAITA)</a>
for their Windows client. In summary, DAITA consists of three components: the
traffic analysis defense framework
<a href="https://github.com/maybenot-io/maybenot">Maybenot</a>, tailored defenses
implemented in Maybenot, and (significant) integration efforts of Maybenot into
Mullvad VPN&rsquo;s stack.</p>
<blockquote>
<p>DAITA = Maybenot + custom defenses + Mullvad VPN integration</p>
</blockquote>
<p>I have been working with Mullvad on DAITA for a while, focusing on Maybenot and
defense tooling. Maybenot is already open source, and so is <a href="https://github.com/mullvad/mullvadvpn-app/">Mullvad&rsquo;s client
integration</a>. <em>We have so much more
stuff in the pipeline to share as open source and open access</em>, but for now, I
want to share some evaluation results from using the first eight DAITA servers
<em>from the perspective of a Windows client</em>.</p>
<h2 id="the-servers">The servers</h2>
<p>The <a href="https://mullvad.net/en/servers">first eight DAITA servers</a> were deployed in
the following locations:</p>
<p><a href="/daita-v1-servers.png"><img src="/daita-v1-servers.png"></a></p>
<p>It is a healthy mix of locations, providers, and types of servers.</p>
<p>All servers run the same customized Maybenot defenses. Details on the actual
defenses are another topic, but for now, it is enough to know that they are
heavily randomized, and each WireGuard connection will likely behave quite
differently.</p>
<h2 id="evaluation-goal">Evaluation goal</h2>
<p>We want to compare the eight servers regarding defense level and performance
overheads. Being geographically distributed, we want to understand how the
defenses perform in vastly different network conditions.</p>
<h2 id="attack-setup">Attack setup</h2>
<p>Our attack scenario is an attacker that, somehow, knows that a client visited
the website for <a href="https://www.kau.se/en">Karlstad University, Sweden</a> (e.g., due
to <a href="https://mullvad.net/en/blog/dns-traffic-can-leak-outside-the-vpn-tunnel-on-android">a DNS
leak</a>)
and wants to determine the webpage (of the university) the client visited. This
type of traffic analysis attack is called a web<em>page</em> fingerprinting attack in
the academic literature, a particular case of <a href="https://www-users.cse.umn.edu/~hoppernj/sok_wf_def_sp23.pdf">web<em>site</em>
fingerprinting</a>.</p>
<p>Karlstad University&rsquo;s website is hosted in Sweden, which was chosen to reduce
the variability caused by websites being mirrored across the world (e.g., using
CDNs).</p>
<h2 id="experiment-setup">Experiment setup</h2>
<p>We set up 20 Windows 11 VMs in Sweden connected to <a href="https://sunet.se/en">Sunet</a>,
the Swedish university network. Each runs the Mullvad client and <a href="https://mullvad.net/en/browser">Mullvad
Browser</a>, which is controlled by a Python script
using <a href="https://www.selenium.dev/">Selenium</a>. Network traffic is captured at each
client using <a href="https://www.wireshark.org/docs/man-pages/tshark.html">tshark</a>.</p>
<p>The primary source of latency between the client and the Karlstad University
website (both hosted in Sweden by Sunet) will be the location of the DAITA
server (and potential congestion caused by defenses, as we will soon see). Below
are the results of pinging the DAITA servers from the client VMs.</p>
<pre tabindex="0"><code>ping -c 100 nl-ams-wg-002.relays.mullvad.net
rtt min/avg/max/mdev = 20.346/20.454/20.700/0.056 ms

ping -c 100 nl-ams-wg-103.relays.mullvad.net
rtt min/avg/max/mdev = 23.442/23.558/24.461/0.101 ms

ping -c 100 gb-lon-wg-008.relays.mullvad.net
rtt min/avg/max/mdev = 25.011/25.106/25.228/0.042 ms

ping -c 100 gb-lon-wg-304.relays.mullvad.net
rtt min/avg/max/mdev = 30.718/30.799/30.961/0.041 ms

ping -c 100 us-lax-wg-203.relays.mullvad.net
rtt min/avg/max/mdev = 185.640/186.107/202.877/1.802 ms

ping -c 100 us-lax-wg-406.relays.mullvad.net
rtt min/avg/max/mdev = 176.737/177.205/178.312/0.214 ms

ping -c 100 us-nyc-wg-303.relays.mullvad.net
rtt min/avg/max/mdev = 107.457/107.563/108.538/0.109 ms

ping -c 100 us-nyc-wg-601.relays.mullvad.net
rtt min/avg/max/mdev = 100.712/100.852/101.999/0.182 ms
</code></pre><h2 id="data-collection">Data collection</h2>
<p>Between 2024-05-29 and 2024-06-02, we collected 16 datasets in the form of
<em>PCAPs from our 20 experiment Windows clients</em>: one for each of the 8 servers
with and without DAITA (&ldquo;undefended&rdquo; below). Each dataset comprises 100 samples
of 50 Karlstad University webpages visited using the Mullvad Browser. In total,
we collected 80,000 network traces.</p>
<h2 id="results">Results</h2>
<p>We processed the data, computed performance metrics, and evaluated using two
state-of-the-art deep-learning-based website fingerprinting attacks: <a href="https://dl.acm.org/doi/pdf/10.1145/3243734.3243768">Deep
Fingerprinting (DF)</a> and
<a href="https://www.usenix.org/conference/usenixsecurity23/presentation/shen-meng">Robust Fingerprinting
(RF)</a>.</p>
<p><a href="/daita-v1-first-8-eval.png"> <img src="/daita-v1-first-8-eval.png"></a></p>
<h2 id="some-key-takeaways">Some key takeaways</h2>
<p>DAITA reduces the success rate of both DF and RF attacks, with more prolonged
traces (US servers) offering slightly less protection. The protection costs
around 2-4 MiB of bandwidth overhead and 1-3 seconds of delay per website visit,
depending on server (and website) location.</p>
<p>The defenses are padding-only defenses that create so much padding traffic that
congestion occurs, implicitly introducing notable delays. In the future,
defenses should explicitly create short, useful (for protection) delays and aim
to account for congestion to minimize delays.</p>
<p>The user experience of enabling DAITA when browsing with Mullvad Browser is less
than changing the server location from Europe to the US. Recall that the
Karlstad University website is hosted in Sweden, so the traffic crossed the
Atlantic twice in our experiment (unlike most regular website visits most users
do). Not great, but not terrible. Much can and will be improved&hellip;stay tuned!</p>

</div>

        </div><div id="footer" class="mb-5">
    
</div>
</body>
</html>
